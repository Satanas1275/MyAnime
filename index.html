<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Catalogue VoidAnime</title>
  <style>
    body {
      background-color: #1a1a1a;
      color: white;
      font-family: sans-serif;
      margin: 0;
      padding: 1rem;
    }
    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }
    #catalogue {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
    }
    .anime-item {
      background-color: #2c2c2c;
      border-radius: 8px;
      overflow: hidden;
      width: 160px;
      text-align: center;
      padding: 0.5rem;
      position: relative;
      text-decoration: none;
      color: white;
      transition: background-color 0.2s ease;
    }
    .anime-item:hover {
      background-color: #3a3a3a;
    }
    .anime-item img {
      width: 100%;
      height: auto;
      border-radius: 4px;
    }
    .anime-item-title {
      font-size: 0.9rem;
      margin-top: 0.5rem;
    }
    .lang-badge {
      display: inline-block;
      font-size: 0.7rem;
      margin-top: 0.25rem;
      padding: 0.2rem 0.4rem;
      background-color: #ff4757;
      border-radius: 4px;
      color: white;
    }
  </style>
</head>
<body>
  <h1>Catalogue VoidAnime</h1>
  <div id="catalogue">Chargement…</div>

  <script>
    function formatAnimeName(name) {
      return name
        .normalize("NFD").replace(/[\u0300-\u036f]/g, "") // Enlève accents
        .replace(/[^a-zA-Z0-9 ]/g, "") // Supprime caractères spéciaux
        .replace(/\s+/g, "-") // Espaces → tirets
        .toLowerCase();
    }

    async function loadCatalogue() {
      const res = await fetch("https://corsproxy.io/?https://anime-sama.fr/catalogue/?type%5B0%5D=Anime&search=&page=1");
      const html = await res.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, "text/html");
      const catalogDiv = doc.querySelector("#list_catalog");
      if (!catalogDiv) return;

      document.getElementById("catalogue").innerHTML = "";

      catalogDiv.querySelectorAll("a").forEach(a => {
        const title = a.querySelector("h1")?.innerText || "Inconnu";
        const img = a.querySelector("img")?.src || "";
        const lang = a.querySelector("p:last-of-type")?.innerText.trim() || "VF";

        const safeName = formatAnimeName(title);

        const item = document.createElement("a");
        item.className = "anime-item";
        item.href = `watch?V=${safeName}&lang=${lang.toLowerCase()}`;

        item.innerHTML = `
          <img src="${img}" alt="${title}">
          <div class="anime-item-title">${title}</div>
          <div class="lang-badge">${lang}</div>
        `;

        document.getElementById("catalogue").appendChild(item);
      });
    }

    loadCatalogue();
  </script>
</body>

</html>

